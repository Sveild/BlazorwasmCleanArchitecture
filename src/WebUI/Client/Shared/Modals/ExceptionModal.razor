@using Newtonsoft.Json

@if (_initialized)
{
    <MudDialog>
        <DialogContent>
            @_message
        </DialogContent>
        <DialogActions>
            <MudButton Color="Color.Primary" OnClick="Submit">Ok</MudButton>
        </DialogActions>
    </MudDialog>
}

@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }
    
    [Parameter] public Exception Exception { get; set; }

    private string _message;
    private bool _initialized;

    protected override void OnInitialized()
    {
        base.OnInitialized();

        if (Exception.GetType().IsAssignableTo(typeof(APIException)))
        {
            _message = ((APIException) Exception).Response;
        }
        else
        {
            _message = Exception.Message;
        }

        _initialized = true;
    }

    void Submit() => MudDialog.Close(DialogResult.Ok(true));
}